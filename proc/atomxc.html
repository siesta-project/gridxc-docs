<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="Library to compute exchange-correlation energies and potentials">
    
    <meta name="author" content="Jose Soler, Alberto Garcia" >
    <link rel="icon" href="../favicon.png">

    <title>atomXC &ndash; libGridXC</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">libGridXC </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>Overview</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             

          </ul>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>atomXC
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title="25.2% of total for procedures.">295 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/atomxc.F90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/atomxc.f90.html'>atomxc.F90</a></li>
    
     <li><a href='../module/m_atomxc.html'>m_atomXC</a></li>
    
  
     <li class="active">atomXC</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<em>None</em>


</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine atomXC(irel, nr, maxr, rmesh, nSpin, Dens, Ex, Ec, Dx, Dc, Vxc)
    
    
   
</h2>
    
  
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Uses</h3>
      </div>
      <ul class="list-group">
      
      <li class="list-group-item">
  <ul class="list-inline">
    
    <li>alloc</li>
    
    <li>alloc</li>
    
    <li>mesh1d</li>
    
    <li>sys</li>
    
    <li><a href='../module/xcmod.html'>xcmod</a></li>
    
    <li>m_ggaxc</li>
    
    <li>mesh1d</li>
    
    <li>m_ldaxc</li>
    
    <li>m_radfft</li>
    
    <li>alloc</li>
    
    <li>mesh1d</li>
    
    <li>mesh1d</li>
    
    <li>m_vdwxc</li>
    
    <li>m_vdwxc</li>
    
    <li>m_vdwxc</li>
    
    <li>m_vdwxc</li>
    
    <li>m_vdwxc</li>
    
    <li>m_vdwxc</li>
    
    <li>precision</li>
    
    <li>alloc</li>
    
    <li><a href='../module/gridxc_config.html'>gridxc_config</a></li>
    
    <li>xc_f90_types_m</li>
    
    <li>xc_f90_lib_m</li>
    
  </ul>
      </li>
      
      
      
      </ul>
    </div>
    


    
    <p>Finds total exchange-correlation energy and potential for a
 spherical electron density distribution.</p>
<div class="codehilite"><pre><span></span> This version implements the Local (spin) Density Approximation and
 the Generalized-Gradient-Aproximation with the &#39;explicit mesh 
 functional&#39; approach of White &amp; Bird, PRB 50, 4954 (1994).
 Gradients are &#39;defined&#39; by numerical derivatives, using 2*nn+1 mesh
   points, where nn is a parameter defined below
 Ref: L.C.Balbas et al, PRB 64, 165110 (2001)
 Written by J.M.Soler using algorithms developed by 
   L.C.Balbas, J.L.Martins and J.M.Soler, Dec.1996
 Van der Waals functional added by J.M.Soler, Jul.2008, as explained in
   G.Roman-Perez and J.M.Soler, PRL 103, 096102 (2009)
 ************************* INPUT ***********************************
 INTEGER irel         : Relativistic exchange? (0=&gt;no, 1=&gt;yes)
 INTEGER nr           : Number of radial mesh points
 INTEGER maxr         : Physical first dimension of Dens and Vxc
 REAL*8  rmesh(nr)    : Radial mesh points. Must be nr.le.maxr
 INTEGER nSpin        : nSpin=1 =&gt; unpolarized; nSpin=2 =&gt; polarized
 REAL*8  Dens(maxr,nSpin) : Total (nSpin=1) or spin (nSpin=2) electron
                            density at mesh points
 ************************* OUTPUT **********************************
 REAL*8  Ex              : Total exchange energy
 REAL*8  Ec              : Total correlation energy
 REAL*8  Dx              : IntegralOf( rho * (eps_x - v_x) )
 REAL*8  Dc              : IntegralOf( rho * (eps_c - v_c) )
 REAL*8  Vxc(maxr,nSpin) : (Spin) exch-corr potential
 ************************ UNITS ************************************
 Distances in atomic units (Bohr).
 Densities in atomic units (electrons/Bohr**3)
 Energy unit depending of parameter Eunit below (currently Rydberg)
</pre></div>
    

    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-irel"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>irel</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-nr"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>nr</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-maxr"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>maxr</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-rmesh"></span>real(kind=dp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>rmesh</strong>(nr)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-nspin"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>nSpin</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-dens"></span>real(kind=dp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>Dens</strong>(maxr,nSpin)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ex"></span>real(kind=dp),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>Ex</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ec"></span>real(kind=dp),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>Ec</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-dx"></span>real(kind=dp),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>Dx</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-dc"></span>real(kind=dp),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>Dc</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-vxc"></span>real(kind=dp),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>Vxc</strong>(maxr,nSpin)</td><td></td>
  
</tr>

</tbody>
</table>

    
    
    
    
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<em>None</em>


    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2020 <a rel="license" href="http://www.freebsd.org/copyright/freebsd-doc-license.html">FreeBSD Documentation License</a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> libGridXC was developed by Jose Soler, Alberto Garcia</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    
  </body>
</html>